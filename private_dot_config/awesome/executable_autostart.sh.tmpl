#!/usr/bin/env bash

usage() {
	echo -e "Usage:"
	echo -e "-b\tbar"
}

run() {
	if ! pgrep $1 ; then
		$@&
	fi
}

bar=""
while getopts "b:h" OPTION; do
	case ${OPTION} in
		b)
			bar="${OPTARG}"
			;;

		h)
			usage
			exit 0
			;;

		*)
			usage
			exit 1
			;;
	esac
done

if [[ -z "${bar}" ]]; then
	echo "You must specify what bar to use!"
	exit 1
fi


# Daemonize compton
run compton -c --backend glx --vsync opengl-swc --blur-background

{{- if contains "laptop" .chezmoi.hostname }}

# Wifi applet
run nm-applet
{{- end }}

# Blue light filter
run redshift

if [[ "${bar}" = "polybar" ]]; then
	run "${HOME}/.config/polybar/launch.sh"
fi

exit 0
